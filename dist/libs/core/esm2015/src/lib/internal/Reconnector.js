import areOptionsEqual from '../utils/areOptionsEqual';
export class Reconnector {
    constructor(backendConnector) {
        this.backendConnector = backendConnector;
        this.reconnect = (parentHandlerId) => {
            if (this.disconnect) {
                this.disconnect();
                this.disconnect = null;
            }
            this.handlerId = parentHandlerId;
            if (this.handlerId && this.node) {
                this.disconnect = this.backendConnector(this.handlerId, this.node, this.options);
            }
        };
        this.hook = (nativeElement, options) => {
            if (nativeElement === this.node &&
                areOptionsEqual(options, this.options)) {
                return;
            }
            this.node = nativeElement;
            this.options = options;
            this.reconnect(this.handlerId);
        };
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiUmVjb25uZWN0b3IuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi8uLi9saWJzL2NvcmUvc3JjL2xpYi9pbnRlcm5hbC9SZWNvbm5lY3Rvci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFDQSxPQUFPLGVBQWUsTUFBTSwwQkFBMEIsQ0FBQztBQUV2RCxNQUFNLE9BQU8sV0FBVztJQUtwQixZQUNZLGdCQUEwRTtRQUExRSxxQkFBZ0IsR0FBaEIsZ0JBQWdCLENBQTBEO1FBRXRGLGNBQVMsR0FBRyxDQUFDLGVBQWtDLEVBQUUsRUFBRTtZQUMvQyxJQUFJLElBQUksQ0FBQyxVQUFVLEVBQUU7Z0JBQ2pCLElBQUksQ0FBQyxVQUFVLEVBQUUsQ0FBQztnQkFDbEIsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUM7YUFDMUI7WUFDRCxJQUFJLENBQUMsU0FBUyxHQUFHLGVBQWUsQ0FBQztZQUNqQyxJQUFJLElBQUksQ0FBQyxTQUFTLElBQUksSUFBSSxDQUFDLElBQUksRUFBRTtnQkFDN0IsSUFBSSxDQUFDLFVBQVUsR0FBRyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBRSxJQUFJLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxPQUFPLENBQUMsQ0FBQzthQUNwRjtRQUNMLENBQUMsQ0FBQTtRQUNELFNBQUksR0FBRyxDQUFDLGFBQW1CLEVBQUUsT0FBVyxFQUFFLEVBQUU7WUFDeEMsSUFBSSxhQUFhLEtBQUssSUFBSSxDQUFDLElBQUk7Z0JBQzNCLGVBQWUsQ0FBQyxPQUFPLEVBQUUsSUFBSSxDQUFDLE9BQU8sQ0FBQyxFQUFFO2dCQUN4QyxPQUFPO2FBQ1Y7WUFFRCxJQUFJLENBQUMsSUFBSSxHQUFHLGFBQWEsQ0FBQztZQUMxQixJQUFJLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQztZQUV2QixJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUNuQyxDQUFDLENBQUE7SUFyQkUsQ0FBQztDQXNCUCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFVuc3Vic2NyaWJlLCBJZGVudGlmaWVyIH0gZnJvbSAnZG5kLWNvcmUnO1xuaW1wb3J0IGFyZU9wdGlvbnNFcXVhbCBmcm9tICcuLi91dGlscy9hcmVPcHRpb25zRXF1YWwnO1xuXG5leHBvcnQgY2xhc3MgUmVjb25uZWN0b3I8TyA9IGFueT4ge1xuICAgIGhhbmRsZXJJZDogYW55O1xuICAgIG5vZGU/OiBOb2RlO1xuICAgIG9wdGlvbnM/OiBPO1xuICAgIGRpc2Nvbm5lY3Q/OiBVbnN1YnNjcmliZSB8IG51bGw7XG4gICAgY29uc3RydWN0b3IoXG4gICAgICAgIHByaXZhdGUgYmFja2VuZENvbm5lY3RvcjogKGhhbmRsZXJJZDogYW55LCBub2RlOiBOb2RlLCBvcHRpb25zPzogTykgPT4gVW5zdWJzY3JpYmVcbiAgICApIHt9XG4gICAgcmVjb25uZWN0ID0gKHBhcmVudEhhbmRsZXJJZDogSWRlbnRpZmllciB8IG51bGwpID0+IHtcbiAgICAgICAgaWYgKHRoaXMuZGlzY29ubmVjdCkge1xuICAgICAgICAgICAgdGhpcy5kaXNjb25uZWN0KCk7XG4gICAgICAgICAgICB0aGlzLmRpc2Nvbm5lY3QgPSBudWxsO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaGFuZGxlcklkID0gcGFyZW50SGFuZGxlcklkO1xuICAgICAgICBpZiAodGhpcy5oYW5kbGVySWQgJiYgdGhpcy5ub2RlKSB7XG4gICAgICAgICAgICB0aGlzLmRpc2Nvbm5lY3QgPSB0aGlzLmJhY2tlbmRDb25uZWN0b3IodGhpcy5oYW5kbGVySWQsIHRoaXMubm9kZSwgdGhpcy5vcHRpb25zKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBob29rID0gKG5hdGl2ZUVsZW1lbnQ6IE5vZGUsIG9wdGlvbnM/OiBPKSA9PiB7XG4gICAgICAgIGlmIChuYXRpdmVFbGVtZW50ID09PSB0aGlzLm5vZGUgJiZcbiAgICAgICAgICAgIGFyZU9wdGlvbnNFcXVhbChvcHRpb25zLCB0aGlzLm9wdGlvbnMpKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB0aGlzLm5vZGUgPSBuYXRpdmVFbGVtZW50O1xuICAgICAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zO1xuXG4gICAgICAgIHRoaXMucmVjb25uZWN0KHRoaXMuaGFuZGxlcklkKTtcbiAgICB9XG59XG4iXX0=